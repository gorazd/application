{% set pageTitle = title | default(site.siteName) %}
{% set pageDescription = description | default('') %}
{% set siteUrl = site.url %}
{% if siteUrl | slice(-1) == '/' %}
  {% set siteUrl = siteUrl | slice(0, -1) %}
{% endif %}
{% set canonicalUrl = siteUrl ~ page.url %}
{% set rawImage = image | default(site.shareImage) %}
{% if rawImage %}
  {% if rawImage | slice(0,4) == 'http' %}
    {% set socialImage = rawImage %}
  {% elif rawImage | slice(0,1) == '/' %}
    {% set socialImage = siteUrl ~ rawImage %}
  {% else %}
    {% set socialImage = siteUrl ~ '/' ~ rawImage %}
  {% endif %}
{% endif %}

<link rel="canonical" href="{{ canonicalUrl }}">
<meta property="og:title" content="{{ pageTitle }}">
<meta property="og:description" content="{{ pageDescription }}">
<meta property="og:type" content="website">
<meta property="og:url" content="{{ canonicalUrl }}">
<meta property="og:site_name" content="{{ site.siteName }}">
<meta property="og:locale" content="{{ site.locale }}">
{% if socialImage %}
<meta property="og:image" content="{{ socialImage }}">
{% endif %}

<meta name="twitter:card" content="{% if socialImage %}summary_large_image{% else %}summary{% endif %}">
<meta name="twitter:title" content="{{ pageTitle }}">
<meta name="twitter:description" content="{{ pageDescription }}">
{% if site.twitterSite %}
<meta name="twitter:site" content="{{ site.twitterSite }}">
{% endif %}
{% if socialImage %}
<meta name="twitter:image" content="{{ socialImage }}">
{% endif %}
