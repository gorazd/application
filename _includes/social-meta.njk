{% set pageTitle = title | default(site.siteName) %}
{% set pageDescription = description | default('') %}
{% set siteUrl = site.url | replace(r/\/+$/, '') %}
{% set canonicalUrl = siteUrl ~ page.url %}
{% set rawImage = image | default(site.shareImage) %}
{% if rawImage %}
  {% if rawImage.startsWith('http') %}
    {% set socialImage = rawImage %}
  {% else %}
    {% set imagePath = rawImage | replace(r/^\/+/, '') %}
    {% set socialImage = siteUrl ~ '/' ~ imagePath %}
  {% endif %}
{% endif %}

<link rel="canonical" href="{{ canonicalUrl }}">
<meta property="og:title" content="{{ pageTitle }}">
<meta property="og:description" content="{{ pageDescription }}">
<meta property="og:type" content="website">
<meta property="og:url" content="{{ canonicalUrl }}">
<meta property="og:site_name" content="{{ site.siteName }}">
<meta property="og:locale" content="{{ site.locale }}">
{% if socialImage %}
<meta property="og:image" content="{{ socialImage }}">
{% endif %}

<meta name="twitter:card" content="{% if socialImage %}summary_large_image{% else %}summary{% endif %}">
<meta name="twitter:title" content="{{ pageTitle }}">
<meta name="twitter:description" content="{{ pageDescription }}">
{% if site.twitterSite %}
<meta name="twitter:site" content="{{ site.twitterSite }}">
{% endif %}
{% if socialImage %}
<meta name="twitter:image" content="{{ socialImage }}">
{% endif %}
